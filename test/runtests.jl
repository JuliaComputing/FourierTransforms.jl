import FourierTransforms, Random#, FFTW
import FourierTransforms: fft_kernel_sizes
using Test

# Ideally, we'd just test against FFTW but currently AbstractFFT doesn't support
# having two backends loaded simultanously so, for now, we test against hardcoded
# values (for seed 123).
_fft_results = Dict(
    3 => [
2.382921370479824 + 0.0im
-0.03878917244505731 - 0.23084453266234775im
-0.03878917244505731 + 0.23084453266234775im
    ],

    5 => [
3.0916184386224517 + 0.0im
0.29070817384199765 - 0.7602716886603696im
0.0846017948382012 - 0.10382612057958596im
0.0846017948382012 + 0.10382612057958596im
0.29070817384199765 + 0.7602716886603696im
    ],

    6 => [
3.754173255096105 + 0.0im
0.6809281462680885 - 0.5531087080798736im
-0.13123544625053474 + 0.07166754649233142im
-0.24287260395179322 + 0.0im
-0.13123544625053474 - 0.07166754649233142im
0.6809281462680885 + 0.5531087080798736im
    ],

    7 => [
4.340195379402908 + 0.0im
0.784311774914068 - 0.32394086637197733im
-0.33353046196774494 - 0.27638333589169806im
0.06868786054021742 - 0.22504078512583983im
0.06868786054021742 + 0.22504078512583983im
-0.33353046196774494 + 0.27638333589169806im
0.784311774914068 + 0.32394086637197733im
    ],

    8 => [
4.392328542571565 + 0.0im
0.4089873863938827 - 0.527247965610534im
-0.17828918787078174 - 1.1554835416850753im
0.5014200523842197 - 0.3513748250880051im
0.2910163571863533 + 0.0im
0.5014200523842197 + 0.3513748250880051im
-0.17828918787078174 + 1.1554835416850753im
0.4089873863938827 + 0.527247965610534im
    ],

    9 => [
4.6609681111165155 + 0.0im
0.4131098177594761 - 0.7597428512230604im
0.552879610725661 - 1.2639152907391837im
0.2944003121994645 + 0.25916759363025416im
-0.13285925785829483 - 0.009059622891359004im
-0.13285925785829483 + 0.009059622891359004im
0.2944003121994645 - 0.25916759363025416im
0.552879610725661 + 1.2639152907391837im
0.4131098177594761 + 0.7597428512230604im
    ],

    10 => [
4.769838852464956 + 0.0im
0.3803093330203081 - 1.0404913170304553im
0.9084861037846448 - 1.0868103485751217im
-0.3409697784044483 - 0.09147422976959417im
0.2841006991584351 - 0.5901984942462337im
0.4507851843828625 + 0.0im
0.2841006991584351 + 0.5901984942462337im
-0.3409697784044483 + 0.09147422976959417im
0.9084861037846448 + 1.0868103485751217im
0.3803093330203081 + 1.0404913170304553im
    ],

    12 => [
5.406521488046341 + 0.0im
0.9155125620064749 - 1.3060974156299585im
1.204501824842993 - 0.2795227060232793im
-0.07331543881183222 - 0.7913374669381343im
0.08492973575721396 + 0.5270734153800118im
-0.29492047052534176 - 0.34498716426817694im
0.1414341877734815 + 0.0im
-0.29492047052534176 + 0.34498716426817694im
0.08492973575721396 - 0.5270734153800118im
-0.07331543881183222 + 0.7913374669381343im
1.204501824842993 + 0.2795227060232793im
0.9155125620064749 + 1.3060974156299585im
    ],

    14 => [
6.889425519436974 + 0.0im
1.9159430184115187 - 0.6312737939261467im
0.5985092934870626 + 0.8205985563941188im
-0.06320501006559744 - 0.7252121893219446im
-0.9594135155040906 - 0.5063888330479352im
0.45968556215200546 - 0.1787864562379981im
-0.21177560342316648 - 0.36357240103372196im
0.38935444319953993 + 0.0im
-0.21177560342316648 + 0.36357240103372196im
0.45968556215200546 + 0.1787864562379981im
-0.9594135155040906 + 0.5063888330479352im
-0.06320501006559744 + 0.7252121893219446im
0.5985092934870626 - 0.8205985563941188im
1.9159430184115187 + 0.6312737939261467im
    ],

    15 => [
7.175123419822292 + 0.0im
1.771186640439782 - 0.369944795865468im
-0.2405257358762754 + 0.49802231541640773im
0.1069131021234103 - 1.4106850938705418im
-0.2756936185361536 - 1.3339455704372096im
0.49874698498175707 + 0.23973139329809748im
0.2921959658560057 - 0.4645156159315149im
0.022972515074601907 + 0.28139134971795843im
0.022972515074601907 - 0.28139134971795843im
0.2921959658560057 + 0.4645156159315149im
0.49874698498175707 - 0.23973139329809748im
-0.2756936185361536 + 1.3339455704372096im
0.1069131021234103 + 1.4106850938705418im
-0.2405257358762754 - 0.49802231541640773im
1.771186640439782 + 0.369944795865468im
    ],

    16 => [7.638970628084186 + 0.0im
1.7500644722629444 - 0.15169819474065185im
-0.5539185421890618 - 0.05205031475142868im
0.9404427088678434 - 1.5257634735368089im
0.5063988042111955 - 0.9449821466585266im
-0.23776700970908415 + 0.7249585969672004im
0.2707808312403752 - 0.12024133602753234im
-0.45350774481522815 - 0.10964887463994968im
0.21120513532296314 + 0.0im
-0.45350774481522815 + 0.10964887463994968im
0.2707808312403752 + 0.12024133602753234im
-0.23776700970908415 - 0.7249585969672004im
0.5063988042111955 + 0.9449821466585266im
0.9404427088678434 + 1.5257634735368089im
-0.5539185421890618 + 0.05205031475142868im
1.7500644722629444 + 0.15169819474065185im
    ],

    20 => [
9.199656891864862 + 0.0im
1.3021775176251122 + 0.17671534519662274im
0.33418354446058035 - 1.6056651492836835im
0.9929861036662608 + 0.8089420959810252im
-0.0972904569418298 - 1.3497602938349755im
0.1999001392669537 - 1.135568908773029im
-1.003301200594018 - 0.04041735765061883im
0.5983871084489962 - 0.5489232566849607im
0.6437508095546978 - 0.6052816400209378im
-0.06954159045448094 + 0.22533436181367733im
0.366792662001991 + 0.0im
-0.06954159045448094 - 0.22533436181367733im
0.6437508095546978 + 0.6052816400209378im
0.5983871084489962 + 0.5489232566849607im
-1.003301200594018 + 0.04041735765061883im
0.1999001392669537 + 1.135568908773029im
-0.0972904569418298 + 1.3497602938349755im
0.9929861036662608 - 0.8089420959810252im
0.33418354446058035 + 1.6056651492836835im
1.3021775176251122 - 0.17671534519662274im
    ],

    25 => [
11.480722582686784 + 0.0im
1.1077754426536335 + 0.3778268885827214im
1.4697641944408146 - 0.9930285824844755im
-0.735945474716562 - 0.5606609542381454im
1.7516397373659491 + 0.26226059821347786im
-0.10542996482014377 - 1.1275916353409234im
0.13717863029325184 - 0.6115880172008579im
-1.2814557101603632 - 0.897976460944378im
-0.5924400270720316 + 0.2553931955391614im
0.17674352780989055 - 1.4389272917843323im
1.2760083011389298 - 1.140732423299813im
0.24487520030807508 + 0.14523536370746715im
0.41652079137228804 + 0.28556167120903375im
0.41652079137228815 - 0.2855616712090337im
0.24487520030807497 - 0.14523536370746676im
1.2760083011389298 + 1.140732423299813im
0.17674352780989067 + 1.4389272917843323im
-0.5924400270720313 - 0.2553931955391614im
-1.2814557101603634 + 0.8979764609443779im
0.13717863029325172 + 0.6115880172008576im
-0.10542996482014377 + 1.1275916353409234im
1.751639737365949 - 0.2622605982134779im
-0.7359454747165621 + 0.5606609542381452im
1.4697641944408146 + 0.9930285824844757im
1.1077754426536335 - 0.3778268885827215im
    ],

    32 => [16.582458535477322 + 0.0im
2.1409946431535083 + 1.728729130704651im
1.5355968212052868 + 1.1452741375337467im
0.2676153171782911 - 1.0525383177038856im
-0.8662115330116358 - 0.2100083036654733im
1.773303452472037 + 0.7189459860447044im
0.6130826996314488 - 1.2366376484247572im
-0.1393557032771212 - 0.4677158093984022im
0.2953384412364235 - 0.900697900696529im
-0.9752972566010153 - 0.8170026733908475im
-0.013398454074630806 + 0.38719956249008813im
1.382455289864497 + 0.8767338805829393im
-0.9698848765308921 + 0.5928143205133588im
0.5337148736079331 - 1.3667869460830344im
0.13030714797440857 + 1.1612067210192123im
-1.0424021359680118 + 1.382680947272064im
-1.32385038290814 + 0.0im
-1.0424021359680118 - 1.382680947272064im
0.13030714797440857 - 1.1612067210192123im
0.5337148736079331 + 1.3667869460830344im
-0.9698848765308921 - 0.5928143205133588im
1.382455289864497 - 0.8767338805829393im
-0.013398454074630806 - 0.38719956249008813im
-0.9752972566010153 + 0.8170026733908475im
0.2953384412364235 + 0.900697900696529im
-0.1393557032771212 + 0.4677158093984022im
0.6130826996314488 + 1.2366376484247572im
1.773303452472037 - 0.7189459860447044im
-0.8662115330116358 + 0.2100083036654733im
0.2676153171782911 + 1.0525383177038856im
1.5355968212052868 - 1.1452741375337467im
2.1409946431535083 - 1.728729130704651im
    ],
)

# kernel test
@testset "FFT kernel of size: $ks" for ks in fft_kernel_sizes
    Random.seed!(123)

    data = rand(ks)
    @test FourierTransforms.fft(data) â‰ˆ _fft_results[ks]
end
